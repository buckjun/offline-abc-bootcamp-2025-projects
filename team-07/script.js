// 역할/포즈 템플릿

const roleTemplates = {
  1: [
    "자연스럽게 서서 미소 짓기","손을 주머니에 넣고 서기","고개를 살짝 기울이며 미소 짓기","카메라를 향해 윙크하기","양손을 허리에 올리고 서기","한쪽 발을 살짝 앞으로 내밀기",
    "머리를 뒤로 넘기며 자연스럽게 서기","손으로 머리를 만지작거리기","팔짱 끼고 서기","하늘을 바라보며 미소 짓기","한 손으로 턱을 괴고 생각하는 표정 짓기","머리 위로 손을 올려 하트 만들기",
    "다리를 교차하고 서기","몸을 살짝 옆으로 틀고 카메라 바라보기","카메라를 등지고 뒤돌아보기","한 손으로 모자를 살짝 눌러 쓰기","의자에 앉아 다리를 꼬고 미소 짓기","팔을 벌려 반기는 포즈",
    "손으로 브이(V) 자 만들기","눈을 감고 웃으며 고개 숙이기"
  ],
  2: [
    "서로 마주보고 하트 만들기","어깨동무하기","한 명이 다른 사람 어깨에 팔 걸치기","손을 잡고 걷는 포즈","서로 기대어 서기","한 명이 다른 사람을 뒤에서 감싸 안기",
    "양쪽에서 서로 바라보기","팔짱끼고 나란히 서기","서로 얼굴 가까이 대고 웃기","손을 맞잡고 뛰는 포즈","서로 등을 맞대고 팔짱 끼기","한 명이 다른 사람의 볼을 손으로 감싸기",
    "무릎 꿇고 반지 주는 포즈","같은 옷을 입고 포즈 맞추기","서로의 머리에 손 얹기","같이 점프하며 손 뻗기","한 사람이 다른 사람 뒤에 서서 팔 벌리기",
    "어깨에 머리 기대기","서로 손가락으로 하트 만들기","같이 브이(V) 자 포즈 취하기"
  ],
  3: [
    "가운데에 서서 양쪽 친구와 어깨동무하기","삼각형으로 서서 서로 바라보기","한 명이 가운데서 양쪽을 감싸 안기","손을 맞잡고 원을 만들기","가운데 사람을 중심으로 웃으며 서기",
    "세 명이 팔짱 끼고 서기","양쪽 사람이 가운데 사람 어깨에 팔 걸치기","서로 등을 맞대고 서기","한 명이 점프하는 포즈","손을 들어 브이(V)자 만들기","한 명이 무릎 꿇고 다른 둘이 손을 내밀기","가운데 사람 위로 양옆이 손 하트 만들기",
    "세 명이 나란히 앉아 웃기","두 명이 앉고 한 명이 뒤에서 서서 팔 벌리기","가운데 인물이 눈 감고 포즈, 나머지 둘이 장난치기","같은 포즈로 대칭 형성하기","서로 등을 맞대고 팔짱 끼기",
    "한 명이 카메라 쪽을 가리키고 나머지가 따라 웃기","삼각형 구도로 손을 올리기","다 같이 점프하기"
  ],
  4: [
    "두 명씩 짝지어 포즈 취하기","일렬로 서서 각자 개성 표현하기","가운데 두 명이 손잡고, 양옆 두 명이 손 흔들기","네 명이 원을 만들어 서로 바라보기","두 명은 팔짱끼고, 나머지 두 명은 손 흔들기",
    "두 명씩 나누어 서로 기대어 서기","모두 웃으며 손을 들어 인사하기","일렬로 서서 각자 다른 방향 보기","한 명이 중심에서 점프하기","네 명이 어깨동무 하며 서기",
    "두 명이 앉고 두 명이 서서 대칭 포즈","두 명이 서로 등을 맞대고, 나머지는 브이 포즈","모두 양손을 머리 위로 하트 만들기","두 명이 장난치고 두 명이 웃으며 보기","가운데 두 명이 포즈, 양옆이 뒤돌아보기",
    "두 명은 점프, 두 명은 아래에서 포즈","같은 옷/소품으로 통일감 주기","네 명이 브이 포즈로 대각선 배열","두 명씩 손 잡고 사선 배열","줄지어 앉아 자연스럽게 웃기"
  ],
  5: [
    "가운데에 리더 역할, 양옆에 포즈 추가","한 명이 가운데서 팔 벌리고, 양옆은 손 흔들기","중앙 인물이 앞에서 손을 들고, 나머지 네 명이 뒤에서 포즈 취하기","두 명씩 짝지어 서로 바라보기",
    "가운데 두 명이 팔짱 끼고, 양옆 세 명은 웃으며 서기",
    "모두 손을 들어 브이(V)자 만들기","한 명이 점프하는 동안 다른 사람들은 미소 짓기","일렬로 서서 왼쪽부터 순서대로 포즈 취하기","가운데 인물이 무릎을 살짝 굽히고, 나머지는 서서 웃기",
    "모두 서로를 바라보며 손 흔들기","두 명이 바닥에 앉고 세 명이 서서 둘러싸기","가운데 한 명이 팔짱 끼고 나머지 둘씩 어깨동무","중앙 인물이 소품 들고 나머지 포즈 맞추기",
    "한 명이 카메라 가리키고 나머지가 놀란 표정","서로 연결된 포즈로 원 만들기","줄 맞춰 같은 포즈 하기","가운데 한 명이 포즈 주도, 나머지 따라하기",
    "5명이 계단처럼 배열 후 포즈","한 명만 다른 동작으로 포인트 주기","각자 방향 다른 채 손 올리기"
  ],
};



const relationKeywords = {
  "커플": [
    "눈 맞추기", "미소 짓기", "다정한 분위기", "속삭이기", "부드러운 눈빛", "설렘 가득한 표정", "수줍은 미소", "진지한 눈빛", "장난스러운 표정", "애틋한 표정"
  ],
  "친구": [
    "장난스러운 표정", "웃음", "농담하기", "웃음소리", "자유로운 표정", "깜짝 놀란 표정", "함께 웃기", "장난치는 얼굴", "진지하게 연기하기", "익살스러운 표정"
  ],
  "가족": [
    "따뜻한 표정", "편안한 미소", "포근한 분위기", "서로 격려하는 표정", "다정한 눈빛", "행복한 표정", "부드러운 미소", "든든한 표정", "사랑스러운 표정", "자상한 표정"
  ],
  "지인": [
    "포멀한 표정", "가벼운 미소", "예의 바른 표정", "조용한 표정", "상냥한 눈빛", "친근한 표정", "차분한 표정", "밝은 미소", "진지한 표정", "자연스러운 표정"
  ],
};

// 관계/테마별 키워드
const themeKeywords = {
  "사랑": [
    "다정한 눈빛 교환", "수줍은 미소", "설렘 가득한 표정", "진지한 눈빛", "애틋한 표정", "부드러운 미소", "행복한 표정", "사랑스러운 표정", "애교 있는 표정", "기쁜 표정"
  ],
  "우정": [
    "장난스러운 표정", "함께 웃기", "깜짝 놀란 표정", "진지하게 연기하기", "익살스러운 표정", "밝은 미소", "자유로운 표정", "친근한 표정", "웃음소리", "자연스러운 표정"
  ],
  "혐오": [
    "표정 없는 무표정", "냉담한 표정", "어색한 표정", "시선을 피하는 표정", "불편한 표정", "짜증난 표정", "무심한 표정", "외면하는 표정", "거리감 느껴지는 표정", "딱딱한 표정"
  ],
  "훈훈": [
    "따뜻한 미소", "부드러운 눈빛", "평온한 표정", "조화로운 표정", "포근한 표정", "자상한 표정", "든든한 표정", "행복한 표정", "편안한 미소", "상냥한 표정"
  ],
  "재미": [
    "익살스러운 얼굴 표정", "눈 크게 뜨기", "웃으며 고개 돌리기", "즉흥적인 표정", "비대칭 표정", "장난치는 얼굴", "기발한 표정", "엉뚱한 표정", "재치 있는 표정", "웃긴 표정"
  ],
  "슬픔": [
    "눈을 감고 고개 숙이기", "눈시울 적시는 표정", "슬픈 눈빛", "조용한 표정", "먼 곳 바라보기", "고개를 옆으로 떨구기", "울먹이는 표정", "아련한 표정", "쓸쓸한 표정", "담담한 표정"
  ]
};



function getPoseText(num, relation, theme) {
  const n = parseInt(num);
  // 인원수별 포즈 5개씩
  const commonGroupPoses = [
    "가장 못생긴 사람에게 얼굴 몰아주기","애매한 사람에게 얼굴 몰아주기","큰 사람이 작은 사람 업어주기","작은 사람이 큰 사람 업어주기",
    "무거운 사람이 가벼운 사람 업어주기","가벼운 사람이 무거운 사람 업어주기","모두 카메라가 아닌 엉뚱한 방향 보기","한 사람만 진지하게 포즈, 나머지는 장난치기",
    "모두 동시에 넘어지는 척 하기","손가락으로 서로를 지목하며 혼내기 연기","한 명만 엉뚱한 곳 바라보기","모두 엇갈린 브이(V) 포즈로 혼돈 연출",
    "하나의 소품을 두고 과하게 경쟁하는 연기","가장 키 큰 사람 위로 무지개 그리기","서로 거울처럼 반대 포즈로 대칭 만들기","가장 늦게 온 사람 벌 서는 듯한 포즈",
    "모두 다른 포즈 취하기","한 사람만 카메라를 등지고 깊은 생각에 잠기기"
  ];
  const poseOptions = {
    1: [
      "자연스럽게 서서 미소 짓기","손을 주머니에 넣고 서기", "고개를 살짝 기울이며 미소 짓기","카메라를 향해 윙크하기","양손을 허리에 올리고 서기","한쪽 발을 살짝 앞으로 내밀기",
      "머리를 뒤로 넘기며 자연스럽게 서기","손으로 머리를 만지작거리기","팔짱 끼고 서기","하늘을 바라보며 미소 짓기","한 손으로 턱을 괴고 생각하는 표정 짓기","머리 위로 손을 올려 하트 만들기",
      "다리를 교차하고 서기","몸을 살짝 옆으로 틀고 카메라 바라보기","카메라를 등지고 뒤돌아보기","한 손으로 모자를 살짝 눌러 쓰기","의자에 앉아 다리를 꼬고 미소 짓기",
      "팔을 벌려 반기는 포즈","손으로 브이(V) 자 만들기","눈을 감고 웃으며 고개 숙이기"
    ],
    2: [
      "서로 마주보고 하트 만들기","어깨동무하기","한 명이 다른 사람 어깨에 팔 걸치기","팔짱끼고 서로 밀당하는 척","서로 기대어 서기","한 명이 다른 사람을 뒤에서 감싸 안기","양쪽에서 서로 바라보기",
      "팔짱끼고 나란히 서기","서로 얼굴 가까이 대고 웃기","손을 맞잡고 뛰는 포즈","서로 등을 맞대고 팔짱 끼기","한 명이 다른 사람의 볼을 손으로 감싸기","무릎 꿇고 반지 주는 포즈",
      "서로 거울처럼 반대 포즈로 대칭 만들기","서로의 머리에 손 얹기","같이 점프하며 손 뻗기","한 사람이 다른 사람 뒤에 서서 팔 벌리기","어깨에 머리 기대기","서로 손가락으로 하트 만들기",
      "같이 브이(V) 자 포즈 취하기",
      ...commonGroupPoses
    ],
    3: [
      "가운데에 서서 양쪽 친구와 어깨동무하기","삼각형으로 서서 서로 바라보기","한 명이 가운데서 양쪽을 감싸 안기","손을 맞잡고 원을 만들기","가운데 사람을 중심으로 웃으며 서기",
      "세 명이 팔짱 끼고 서기","양쪽 사람이 가운데 사람 어깨에 팔 걸치기","서로 등을 맞대고 서기","한 명이 점프하는 포즈","손을 들어 브이(V)자 만들기","한 명이 무릎 꿇고 다른 둘이 손을 내밀기",
      "가운데 사람 위로 양옆이 손 하트 만들기","세 명이 나란히 앉아 웃기","두 명이 앉고 한 명이 뒤에서 서서 팔 벌리기","가운데 인물이 눈 감고 포즈, 나머지 둘이 장난치기","같은 포즈로 대칭 형성하기",
      "서로 등을 맞대고 팔짱 끼기","한 명이 카메라 쪽을 가리키고 나머지가 따라 웃기","삼각형 구도로 손을 올리기","다 같이 점프하기",
      ...commonGroupPoses
    ],
    4: [
      "두 명씩 짝지어 업어주기","일렬로 서서 각자 개성 표현하기","가운데 두 명이 손잡고, 양옆 두 명이 손 흔들기","네 명이 원을 만들어 서로 바라보기","두 명은 팔짱끼고, 나머지 두 명은 손 흔들기",
      "두 명씩 나누어 서로 공주님 안기","모두 웃으며 손을 들어 인사하기","일렬로 서서 각자 다른 방향 보기","한 명이 중심에서 점프하기","네 명이 어깨동무 하며 서기",
      "두 명이 앉고 두 명이 서서 대칭 포즈","애매한 사람에게 얼굴 몰아주기","모두 양손을 머리 위로 하트 만들기","두 명이 장난치고 두 명이 웃으며 보기","가운데 두 명이 포즈, 양옆이 뒤돌아보기",
      "두 명은 점프, 두 명은 아래에서 포즈","가장 못생긴 사람에게 얼굴 몰아주기","네 명이 브이 포즈로 대각선 배열","두 명씩 손 잡고 사선 배열","줄지어 앉아 자연스럽게 웃기",
      ...commonGroupPoses
    ],
    5: [
      "가운데에 리더 역할, 양옆에 포즈 추가","한 명이 가운데서 팔 벌리고, 양옆은 손 흔들기","중앙 인물이 앞에서 손을 들고, 나머지 네 명이 뒤에서 포즈 취하기","두 명씩 짝지어 서로 바라보기",
      "가운데 두 명이 팔짱 끼고, 양옆 세 명은 웃으며 서기","모두 손을 들어 브이(V)자 만들기","한 명이 점프하는 동안 다른 사람들은 미소 짓기","일렬로 서서 왼쪽부터 순서대로 포즈 취하기","가운데 인물이 무릎을 살짝 굽히고, 나머지는 서서 웃기",
      "모두 서로를 바라보며 손 흔들기","두 명이 바닥에 앉고 세 명이 서서 둘러싸기","가운데 한 명이 팔짱 끼고 나머지 둘씩 어깨동무","중앙 인물이 소품 들고 나머지 포즈 맞추기","한 명이 카메라 가리키고 나머지가 놀란 표정",
      "서로 연결된 포즈로 원 만들기","줄 맞춰 같은 포즈 하기","가운데 한 명이 포즈 주도, 나머지 따라하기","5명이 계단처럼 배열 후 포즈","한 명만 다른 동작으로 포인트 주기","각자 방향 다른 채 손 올리기",
      ...commonGroupPoses
    ]
  };
  for (let i = 6; i <= 10; i++) {
    poseOptions[i] = [
      `원형으로 둘러서서 손을 잡기`,
      `일렬로 서서 각자 개성 표현하기`,
      `동시에 점프하기`,
      `브이(V)자 포즈로 대각선 배열`,
      `줄지어 앉아 자연스럽게 웃기`
    ];
  }
  // 그룹 조합 생성
  function getRandom(arr, count) {
    const copy = [...arr];
    const result = [];
    while (copy.length && result.length < count) {
      const idx = Math.floor(Math.random() * copy.length);
      result.push(copy.splice(idx, 1)[0]);
    }
    return result;
  }
  // 가능한 그룹 사이즈: 1~현재 남은 인원수까지 모두 허용
  let left = n;
  let groups = [];
  while (left > 0) {
    // 남은 인원에 맞는 그룹 사이즈 선택 (1~left)
    const possible = Array.from({length: left}, (_, i) => i + 1);
    const sz = possible[Math.floor(Math.random() * possible.length)];
    groups.push(sz);
    left -= sz;
  }
  // 각 그룹별 랜덤 포즈, 줄바꿈으로 출력
  let actions = groups.map(sz => {
    const poses = poseOptions[sz] || poseOptions[1];
    const pose = getRandom(poses, 1)[0];
    return `${sz}명이서 ${pose}`;
  }).join("<br>");
  // 키워드: 관계에서 1개 랜덤, 테마에서 2개 랜덤
  function getRandom(arr, count) {
    const copy = [...arr];
    const result = [];
    while (copy.length && result.length < count) {
      const idx = Math.floor(Math.random() * copy.length);
      result.push(copy.splice(idx, 1)[0]);
    }
    return result;
  }
  const relKeys = relationKeywords[relation] || [];
  const themeKeys = themeKeywords[theme] || [];
  const keywords = [];
  if (relKeys.length > 0) keywords.push(...getRandom(relKeys, 1));
  if (themeKeys.length > 0) keywords.push(...getRandom(themeKeys, 2));
  return `<div class='text-left'><b>추천 포즈 설명</b><br>행동 : <br>${actions}<br><br>키워드 : <br>${keywords.join("<br>")}<br><span class='text-blue-500 mt-2'>총 인원 수 : ${n}명</span></div>`;
}



const btn = document.getElementById('generateBtn');
const result = document.getElementById('result');



btn.addEventListener('click', () => {
  const num = document.getElementById('numPeople').value;
  const relation = document.getElementById('relation').value;
  const theme = document.getElementById('theme').value;

  result.innerHTML = '';

  if (!num || !relation || !theme) {
    btn.disabled = false;
    result.innerHTML = '<span class="text-red-500">모든 항목을 선택해주세요.</span>';
    return;
  }

  btn.disabled = true;

  // 검색어 생성
  const searchQuery = `${num}명 ${relation} ${theme} 포즈`;
  const encodedQuery = encodeURIComponent(searchQuery);
  const searchUrl = `https://duckduckgo.com/?t=h_&q=${encodedQuery}&ia=images&iax=images`;

  setTimeout(() => {
    btn.disabled = false;
    // 포즈 추천과 이미지 검색 결과를 함께 표시
    result.innerHTML = `
      <div class='bg-gray-100 rounded p-4 text-lg mb-4 w-full max-w-2xl mx-auto'>
        ${getPoseText(num, relation, theme)}
      </div>
      <div class="bg-white p-4 rounded-lg shadow mb-4">
        <p class="mb-3 text-gray-700">이미지 검색어: ${searchQuery}</p>
        <a href="${searchUrl}" 
           target="_blank" 
           class="text-blue-500 hover:text-blue-700 underline">
           참고 이미지 검색 결과 보기 →
        </a>
      </div>
    `;
  }, 1200);
});

